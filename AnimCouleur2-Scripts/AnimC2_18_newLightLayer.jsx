// Copyright 2013// Compiled (via JavascriptListener or ActionToJavascript Xtools…) by Stéphane Baril// enable double clicking from the Finder or Explorer#target photoshop//Make Photoshop the front most applicationapp.bringToFront();///////////////////////////////////////////////////// SETUP//////////////////////////////////////////////////////////////////////////////////////////////////////// MAIN////////////////////////////////////////////////////////////////////////////////////////////////////////FUNCTIONS///////////////////////////////////////////////////if (documents.length == 0) {    // alert("There are no documents open.");}else {        function newLightLayer() {        // =======================================================        var idaddBlankVideoLayer = stringIDToTypeID( "addBlankVideoLayer" );        executeAction( idaddBlankVideoLayer, undefined, DialogModes.NO );        // =======================================================        var idGrpL = charIDToTypeID( "GrpL" );            var desc229 = new ActionDescriptor();            var idnull = charIDToTypeID( "null" );                var ref65 = new ActionReference();                var idLyr = charIDToTypeID( "Lyr " );                var idOrdn = charIDToTypeID( "Ordn" );                var idTrgt = charIDToTypeID( "Trgt" );                ref65.putEnumerated( idLyr, idOrdn, idTrgt );            desc229.putReference( idnull, ref65 );        executeAction( idGrpL, desc229, DialogModes.NO );        // =======================================================        var idsetd = charIDToTypeID( "setd" );            var desc230 = new ActionDescriptor();            var idnull = charIDToTypeID( "null" );                var ref66 = new ActionReference();                var idLyr = charIDToTypeID( "Lyr " );                var idOrdn = charIDToTypeID( "Ordn" );                var idTrgt = charIDToTypeID( "Trgt" );                ref66.putEnumerated( idLyr, idOrdn, idTrgt );            desc230.putReference( idnull, ref66 );            var idT = charIDToTypeID( "T   " );                var desc231 = new ActionDescriptor();                var idNm = charIDToTypeID( "Nm  " );                desc231.putString( idNm, "Lights" );            var idLyr = charIDToTypeID( "Lyr " );            desc230.putObject( idT, idLyr, desc231 );        executeAction( idsetd, desc230, DialogModes.NO );    };    //=========================================    //                    newLightLayer.main    //=========================================    //    newLightLayer.main = function () {      newLightLayer();    };    app.activeDocument.suspendHistory("Create a New Clipping Lights Layer", 'newLightLayer.main()');    //newLightLayer.main();}